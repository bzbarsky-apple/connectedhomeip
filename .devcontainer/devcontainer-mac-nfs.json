{
    "name": "CHIP Ubuntu Development Environment",
    "runArgs": ["--cap-add=SYS_PTRACE", "--security-opt", "seccomp=unconfined"],
    "mounts": [ "source=/var/run/docker.sock,target=/var/run/docker.sock,type=bind" ],
    // This workspaceMount setup assumes that we are on a Mac and the following
    // modifications have been made to the system:
    //
    // 1) A line like this has been added to /etc/exports:
    //
    //    /path/to/chip/repo -alldirs -mapall=501:20 localhost
    //
    //  where the "501:20" is the output of the command:
    //
    //    echo `id -u`:`id -g`
    //
    //  and the path probably looks like /Users/whatever/connectedhomeip or
    //  the like.  Of course one can also share /Users in its entirety or
    //  whatnot, but the above is the minimal sharing amount needed.
    //
    // 2) A line like this has been added to /etc/nfs.conf:
    //
    //    nfs.server.mount.require_resv_port = 0
    //
    // to tell nfsd to allow connections from any port.
    //
    // 3) "sudo nfsd restart" has been run after steps 1 and 2.
    //
    // The exact "o" options in the string below were copy/pasted from the
    // internet.  The "rw" is clearly desired to have a writable mount, but I
    // have not looked into what the other options (nolock, hard, nointr,
    // nfsvers) actually do.
    "workspaceMount": "type=volume,source=chip-nfs,target=${containerWorkspaceFolder},volume-driver=local,volume-opt=type=nfs,volume-opt=device=:${localWorkspaceFolder},\"volume-opt=o=addr=host.docker.internal,rw,nolock,hard,nointr,nfsvers=3\"",
    "build": {
        "dockerfile": "Dockerfile",
        "args": {
            //  "BUILD_VERSION": "$(cat integrations/docker/images/chip-build/version)" // trying to get this to work
            "BUILD_VERSION": "0.2.9"
        }
    },
    "remoteUser": "vscode",
    // Add the IDs of extensions you want installed when the container is created in the array below.
    "extensions": [
        "ms-azuretools.vscode-docker",
        "xaver.clang-format",
        "github.vscode-pull-request-github",
        "maelvalais.autoconf",
        "yzhang.markdown-all-in-one",
        "eamodio.gitlens",
        "yuichinukiyama.vscode-preview-server",
        "aaron-bond.better-comments",
        "foxundermoon.shell-format",
        "editorconfig.editorconfig",
        "esbenp.prettier-vscode"
    ],
    // Use 'settings' to set *default* container specific settings.json values on container create.
    // You can edit these settings after create using File > Preferences > Settings > Remote.
    "settings": {
        "terminal.integrated.shell.linux": "/bin/bash"
    },
    "postCreateCommand": "source /usr/share/bash-completion/bash_completion && source /etc/bash_completion.d/git-prompt && sudo chgrp docker /var/run/docker.sock",
    "remoteEnv": {
        "GIT_PS1_SHOWDIRTYSTATE": "1",
        "GIT_PS1_SHOWSTASHSTATE": "1",
        "GIT_PS1_SHOWCOLORHINTS": "true",
        "PROMPT_COMMAND": "${localEnv:PROMPT_COMMAND}"
    }
}
